---
import Layout from "@/layouts/Layout.astro"
import Header from "@/components/layout/Header.astro"
import Footer from "@/components/layout/Footer.astro"
import Button from "@/components/ui/Button.astro"
import GSAPWrapper from "@/components/animations/GSAPWrapper.astro"
import PortfolioFilters from "@/components/gallery/PortfolioFilters.astro"
import PortfolioGrid from "@/components/gallery/PortfolioGrid.astro"
import artistsData from "@/data/artists.json"
import stylesData from "@/data/tattoo-styles.json"

const { artists } = artistsData;
const { styles } = stylesData;

// Calcular estadísticas del portfolio
const totalWorks = artists.reduce((total, artist) => total + artist.portfolio.length, 0);
const featuredStyles = styles.filter(style => style.featured);
---

<Layout 
  title="Portfolio Completo | Cuba Tattoo Studio"
  description="Explora nuestra galería completa de tatuajes. Filtra por artista, estilo y más. Trabajos de David, Nina y Karli en Cuba Tattoo Studio, Albuquerque."
>
  <Header />
  
  <main class="pt-20 bg-cuba-black min-h-screen">
    <!-- Hero Section -->
    <GSAPWrapper animation="fade-in" class="py-16 bg-gradient-to-b from-cuba-black to-cuba-gray-600">
      <section class="container mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center max-w-4xl mx-auto">
          <h1 class="text-5xl md:text-7xl font-heading text-cuba-white uppercase tracking-wider mb-6">
            Portfolio Completo
          </h1>
          <p class="text-xl md:text-2xl text-cuba-gray-400 font-body leading-relaxed mb-8">
            Explora nuestra colección completa de {totalWorks} trabajos realizados por nuestros talentosos artistas. Filtra por estilo, artista o características específicas para encontrar la inspiración perfecta.
          </p>
          <div class="w-24 h-1 bg-cuba-white mx-auto mb-8"></div>
          
          <!-- Estadísticas Rápidas -->
          <div class="grid grid-cols-1 md:grid-cols-3 gap-8 max-w-2xl mx-auto">
            <div class="text-center">
              <div class="text-3xl md:text-4xl font-heading text-cuba-white mb-2">
                {totalWorks}
              </div>
              <div class="text-sm font-body text-cuba-gray-400 uppercase tracking-wider">
                Trabajos Realizados
              </div>
            </div>
            <div class="text-center">
              <div class="text-3xl md:text-4xl font-heading text-cuba-white mb-2">
                {artists.length}
              </div>
              <div class="text-sm font-body text-cuba-gray-400 uppercase tracking-wider">
                Artistas Especializados
              </div>
            </div>
            <div class="text-center">
              <div class="text-3xl md:text-4xl font-heading text-cuba-white mb-2">
                {styles.length}+
              </div>
              <div class="text-sm font-body text-cuba-gray-400 uppercase tracking-wider">
                Estilos Diferentes
              </div>
            </div>
          </div>
        </div>
      </section>
    </GSAPWrapper>

    <!-- Estilos Destacados -->
    <GSAPWrapper animation="fade-in" class="py-16">
      <section class="container mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-12">
          <h2 class="text-3xl md:text-4xl font-heading text-cuba-white uppercase tracking-wider mb-4">
            Estilos Destacados
          </h2>
          <p class="text-cuba-gray-400 font-body max-w-2xl mx-auto">
            Nuestros artistas dominan una amplia variedad de estilos, desde los más tradicionales hasta las tendencias más modernas.
          </p>
        </div>
        
        <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4">
          {featuredStyles.map((style, index) => (
            <GSAPWrapper animation="magnetic" intensity="medium" easing="elastic" delay={index * 0.1}>
              <button 
                class="style-showcase-btn p-4 bg-cuba-gray-600 hover:bg-cuba-white hover:text-cuba-black transition-all duration-300 group"
                data-style={style.name.toLowerCase().replace(/\s+/g, '-')}
              >
                <div class="text-center">
                  <div class="w-12 h-12 mx-auto mb-3 bg-cuba-black group-hover:bg-cuba-gray-600 flex items-center justify-center transition-colors duration-300">
                    <svg class="w-6 h-6 text-cuba-white" fill="currentColor" viewBox="0 0 20 20">
                      <path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z" />
                    </svg>
                  </div>
                  <h3 class="text-sm font-heading text-cuba-white group-hover:text-cuba-black uppercase tracking-wider transition-colors duration-300">
                    {style.name}
                  </h3>
                </div>
              </button>
            </GSAPWrapper>
          ))}
        </div>
      </section>
    </GSAPWrapper>

    <!-- Filtros del Portfolio -->
    <section class="container mx-auto px-4 sm:px-6 lg:px-8">
      <GSAPWrapper animation="slide-up">
        <PortfolioFilters />
      </GSAPWrapper>
    </section>

    <!-- Grid del Portfolio -->
    <section class="py-8">
      <div class="container mx-auto px-4 sm:px-6 lg:px-8">
        <GSAPWrapper animation="fade-in">
          <PortfolioGrid />
        </GSAPWrapper>
      </div>
    </section>

    <!-- Sección de Artistas -->
    <GSAPWrapper animation="fade-in" class="py-20 bg-gradient-to-b from-cuba-black to-cuba-gray-600">
      <section class="container mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-16">
          <h2 class="text-4xl md:text-5xl font-heading text-cuba-white uppercase tracking-wider mb-6">
            Conoce a Nuestros Artistas
          </h2>
          <p class="text-cuba-gray-400 font-body text-lg max-w-2xl mx-auto">
            Cada trabajo en nuestro portfolio es el resultado de la experiencia, técnica y visión artística única de nuestros talentosos profesionales.
          </p>
        </div>
        
        <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
          {artists.map((artist, index) => (
            <GSAPWrapper animation="blur-in" intensity="subtle" delay={index * 0.2}>
              <div class="text-center group">
                <div class="aspect-square bg-cuba-gray-600 mb-6 overflow-hidden">
                  <img 
                    src={`https://trae-api-us.mchost.guru/api/ide/v1/text_to_image?prompt=professional%20tattoo%20artist%20${artist.name.toLowerCase()}%20portrait%20black%20and%20white%20studio%20lighting&image_size=square_hd`}
                    alt={`${artist.name} - Artista de tatuajes`}
                    class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-700"
                    loading="lazy"
                  />
                </div>
                
                <h3 class="text-2xl font-heading text-cuba-white uppercase tracking-wider mb-3 group-hover:text-cuba-gray-400 transition-colors duration-300">
                  {artist.name}
                </h3>
                
                <div class="flex flex-wrap justify-center gap-2 mb-4">
                  {artist.specialties.slice(0, 2).map((specialty) => (
                    <span class="px-3 py-1 bg-cuba-gray-600 text-cuba-white text-xs font-body uppercase tracking-wider">
                      {specialty}
                    </span>
                  ))}
                </div>
                
                <p class="text-cuba-gray-400 font-body text-sm mb-6">
                  {artist.portfolio.length} trabajos en portfolio
                </p>
                
                <div class="flex flex-col sm:flex-row gap-3 justify-center">
                  <Button 
                    href={`/artistas/${artist.slug}`} 
                    variant="outline" 
                    size="sm"
                  >
                    Ver Perfil
                  </Button>
                  <Button 
                    href={`/reservas?artist=${artist.slug}`} 
                    variant="primary" 
                    size="sm"
                  >
                    Reservar
                  </Button>
                </div>
              </div>
            </GSAPWrapper>
          ))}
        </div>
      </section>
    </GSAPWrapper>

    <!-- CTA Final -->
    <GSAPWrapper animation="fade-in" class="py-20 bg-gradient-to-t from-cuba-black to-cuba-gray-600">
      <section class="container mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center max-w-3xl mx-auto">
          <h2 class="text-4xl md:text-5xl font-heading text-cuba-white uppercase tracking-wider mb-6">
            ¿Encontraste tu inspiración?
          </h2>
          <p class="text-cuba-gray-400 font-body text-lg leading-relaxed mb-8">
            Nuestro portfolio representa años de experiencia y pasión por el arte del tatuaje. Si algún trabajo te inspiró, no dudes en contactarnos para crear algo único para ti.
          </p>
          
          <div class="flex flex-col sm:flex-row gap-4 justify-center items-center">
            <Button href="/reservas" variant="primary" size="lg">
              Reservar Consulta
            </Button>
            <Button href="/artistas" variant="outline" size="lg">
              Conocer Artistas
            </Button>
          </div>
        </div>
      </section>
    </GSAPWrapper>
  </main>
  
  <Footer />
</Layout>

<script>
  // Funcionalidad adicional para la página de portfolio
  class PortfolioPage {
    constructor() {
      this.styleShowcaseBtns = document.querySelectorAll('.style-showcase-btn');
      this.init();
    }
    
    init() {
      // Event listeners para botones de estilos destacados
      this.styleShowcaseBtns.forEach(btn => {
        btn.addEventListener('click', (e) => {
          const style = e.currentTarget.dataset.style;
          this.filterByStyle(style);
          
          // Scroll to filters section
          const filtersSection = document.querySelector('.portfolio-filters');
          if (filtersSection) {
            filtersSection.scrollIntoView({ 
              behavior: 'smooth', 
              block: 'start' 
            });
          }
        });
      });
    }
    
    filterByStyle(style) {
      // Update style filter
      const styleFilter = document.getElementById('style-filter');
      if (styleFilter) {
        styleFilter.value = style;
        
        // Trigger change event to apply filter
        const changeEvent = new Event('change', { bubbles: true });
        styleFilter.dispatchEvent(changeEvent);
      }
      
      // Update quick filter buttons
      const quickFilterBtns = document.querySelectorAll('.quick-filter-btn');
      quickFilterBtns.forEach(btn => {
        btn.classList.remove('active');
        if (btn.dataset.filter === style) {
          btn.classList.add('active');
        }
      });
    }
  }
  
  // Initialize page functionality when DOM is loaded
  document.addEventListener('DOMContentLoaded', () => {
    new PortfolioPage();
  });
</script>
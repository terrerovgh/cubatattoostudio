---
import { getEntry } from "astro:content";
import "../styles/global.css";
import ChatAssistant from "../components/AI/ChatAssistant";

const chatConfig = await getEntry("chat", "config");
const knowledgeBase = await getEntry("chat", "knowledge");

interface Props {
	title: string;
	description?: string;
	image?: string;
	type?: string;
}

const {
	title,
	description = "Cuba Tattoo Studio - Premier Tattoo Shop in Albuquerque, NM. Custom designs, professional artists, and a welcoming atmosphere.",
	image = "/tattoo/tattoo.webp",
	type = "website",
} = Astro.props;

const canonicalURL = new URL(Astro.url.pathname, Astro.site);
---

<!doctype html>
<html lang="en" class="scroll-smooth">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="generator" content={Astro.generator} />
		<link rel="canonical" href={canonicalURL} />
		<title>{title}</title>
		<meta name="description" content={description} />

		<!-- Open Graph / Facebook -->
		<meta property="og:type" content={type} />
		<meta property="og:url" content={canonicalURL} />
		<meta property="og:title" content={title} />
		<meta property="og:description" content={description} />
		<meta property="og:image" content={new URL(image, Astro.url)} />

		<!-- Twitter -->
		<meta property="twitter:card" content="summary_large_image" />
		<meta property="twitter:url" content={canonicalURL} />
		<meta property="twitter:title" content={title} />
		<meta property="twitter:description" content={description} />
		<meta property="twitter:image" content={new URL(image, Astro.url)} />

		<script type="application/ld+json" is:inline>
			{
				"@context": "https://schema.org",
				"@type": "TattooParlor",
				"name": "Cuba Tattoo Studio",
				"image": "https://cubatattoo.com/tattoo/tattoo.webp",
				"url": "https://cubatattoo.com",
				"telephone": "(555) 123-4567",
				"address": {
					"@type": "PostalAddress",
					"streetAddress": "124 Gold Ave SW",
					"addressLocality": "Albuquerque",
					"addressRegion": "NM",
					"postalCode": "87102",
					"addressCountry": "US"
				},
				"geo": {
					"@type": "GeoCoordinates",
					"latitude": 35.0844,
					"longitude": -106.6504
				},
				"openingHoursSpecification": [
					{
						"@type": "OpeningHoursSpecification",
						"dayOfWeek": [
							"Monday",
							"Tuesday",
							"Wednesday",
							"Thursday",
							"Friday"
						],
						"opens": "11:00",
						"closes": "20:00"
					},
					{
						"@type": "OpeningHoursSpecification",
						"dayOfWeek": ["Saturday", "Sunday"],
						"opens": "12:00",
						"closes": "18:00"
					}
				],
				"priceRange": "$$"
			}
		</script>

		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link
			href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap"
			rel="stylesheet"
		/>
		<script src="https://unpkg.com/lucide@latest"></script>
	</head>
	<body
		class="antialiased selection:bg-red-900 selection:text-white relative"
	>
		<slot />
		<ChatAssistant
			client:idle
			config={chatConfig?.data}
			systemPrompt={chatConfig?.body}
			knowledgeBase={knowledgeBase?.body}
		/>
		<script>
			// Initialize Lucide icons
			// @ts-ignore
			if (typeof lucide !== "undefined") lucide.createIcons();
		</script>
	</body>
</html>

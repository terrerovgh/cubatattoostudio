---
interface Props {
    images: string[];
    artistName: string;
}

const { images, artistName } = Astro.props;
---

<section class="py-16 md:py-24 bg-neutral-950 overflow-hidden">
    <div class="max-w-[1800px] mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center mb-12 md:mb-24 max-w-3xl mx-auto">
            <h2
                class="text-[10px] md:text-xs font-bold text-neutral-500 tracking-[0.5em] mb-3 md:mb-4 uppercase"
            >
                Portfolio
            </h2>
            <h3
                class="text-4xl md:text-7xl font-bold text-white tracking-tighter"
            >
                SELECTED WORKS
            </h3>
        </div>

        <div
            class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-8"
        >
            {
                [0, 1, 2].map((colIndex) => (
                    <div
                        class={`flex flex-col gap-8 parallax-column-${colIndex}`}
                    >
                        {images
                            .filter((_, index) => index % 3 === colIndex)
                            .map((img) => (
                                <div
                                    class="relative group overflow-hidden cursor-zoom-in rounded-sm"
                                    onclick={`window.openImageModal({ image: '${img}', title: 'Tattoo by ${artistName}', artistName: '${artistName}' })`}
                                >
                                    <img
                                        src={img}
                                        alt={`Tattoo by ${artistName}`}
                                        class="w-full h-auto object-cover transition-transform duration-700 ease-out group-hover:scale-105"
                                        loading="lazy"
                                    />
                                    <div class="absolute inset-0 bg-neutral-950/40 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-center justify-center backdrop-blur-[2px]">
                                        <div class="translate-y-4 group-hover:translate-y-0 transition-transform duration-300">
                                            <span class="text-white text-xs font-bold tracking-[0.2em] border border-white/30 px-6 py-3 uppercase hover:bg-white hover:text-black transition-colors">
                                                View Detail
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            ))}
                    </div>
                ))
            }
        </div>
    </div>
</section>

<script>
    import { gsap } from "gsap";
    import { ScrollTrigger } from "gsap/ScrollTrigger";

    gsap.registerPlugin(ScrollTrigger);

    // Only apply parallax on desktop/large screens
    const mm = gsap.matchMedia();

    mm.add("(min-width: 1024px)", () => {
        // Column 0: Standard speed (or slightly slower)
        gsap.to(".parallax-column-0", {
            y: -50,
            ease: "none",
            scrollTrigger: {
                trigger: ".parallax-column-0",
                start: "top bottom",
                end: "bottom top",
                scrub: 1,
            },
        });

        // Column 1: Faster speed (moves more) - deeper effect
        gsap.to(".parallax-column-1", {
            y: -150,
            ease: "none",
            scrollTrigger: {
                trigger: ".parallax-column-1",
                start: "top bottom",
                end: "bottom top",
                scrub: 1.5,
            },
        });

        // Column 2: Slower speed (or reverse) - varied depth
        gsap.to(".parallax-column-2", {
            y: -30,
            ease: "none",
            scrollTrigger: {
                trigger: ".parallax-column-2",
                start: "top bottom",
                end: "bottom top",
                scrub: 0.5,
            },
        });
    });
</script>

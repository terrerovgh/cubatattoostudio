---
import Button from '../ui/Button.astro';
import MicroInteractions from '../ui/MicroInteractions.astro';

const currentPath = Astro.url.pathname;

const navItems = [
  { href: '/', label: 'Home' },
  { href: '/artists', label: 'Artists' },
  { href: '/portfolio', label: 'Portfolio' },
  { href: '/studio', label: 'Studio' },
  { href: '/reservas', label: 'Booking' }
];
---

<header class="fixed top-0 left-0 right-0 z-50 bg-cuba-black/95 backdrop-blur-md border-b border-cuba-gray-600 shadow-2xl">
  <!-- Efecto de resplandor sutil en el header -->
  <div class="absolute inset-0 bg-gradient-to-r from-transparent via-cuba-white to-transparent opacity-5 pointer-events-none"></div>
  
  <nav class="container mx-auto px-4 sm:px-6 lg:px-8 relative">
    <div class="flex items-center justify-between h-16 sm:h-20">
      <!-- Logo con micro-interacciones -->
      <MicroInteractions type="magnetic" intensity="medium">
        <a href="/" class="flex items-center space-x-2 group">
          <img src="/logo.svg" alt="Cuba Tattoo Studio Logo" class="h-10 sm:h-12 w-auto group-hover:scale-110 transition-all duration-500 transform" />
          <div class="hidden sm:block text-sm font-body text-cuba-gray-400 uppercase tracking-wider group-hover:text-cuba-gray-300 transition-colors duration-300">
            Tattoo Studio
          </div>
          <!-- Línea decorativa animada -->
          <div class="absolute -bottom-1 left-0 w-0 h-px bg-cuba-white group-hover:w-full transition-all duration-500"></div>
        </a>
      </MicroInteractions>

      <!-- Desktop Navigation con micro-interacciones -->
      <div class="hidden md:flex items-center space-x-8">
        {navItems.map(({ href, label }) => (
          <MicroInteractions type="hover-lift" intensity="subtle">
            <a
              href={href}
              class={`relative font-body text-sm uppercase tracking-wider transition-all duration-500 hover:text-cuba-white group ${
                currentPath === href ? 'text-cuba-white' : 'text-cuba-gray-400'
              }`}
            >
              {label}
              <!-- Indicador activo mejorado -->
              {currentPath === href && (
                <div class="absolute -bottom-2 left-1/2 transform -translate-x-1/2 w-1 h-1 bg-cuba-white rounded-full animate-pulse"></div>
              )}
              <!-- Efecto hover -->
              <div class="absolute -bottom-1 left-0 w-0 h-px bg-cuba-white group-hover:w-full transition-all duration-500"></div>
              <!-- Resplandor en hover -->
              <div class="absolute inset-0 bg-cuba-white opacity-0 group-hover:opacity-10 blur-sm transition-opacity duration-300 rounded"></div>
            </a>
          </MicroInteractions>
        ))}
      </div>

      <!-- CTA Button con efectos mejorados -->
      <div class="hidden md:block">
        <MicroInteractions type="glow-border" intensity="medium">
          <Button href="/reservas" variant="primary" size="sm" animated={true}>
            Book Appointment
          </Button>
        </MicroInteractions>
      </div>

      <!-- Mobile Menu Button con micro-interacciones -->
      <MicroInteractions type="pulse" intensity="medium">
        <button
          id="mobile-menu-button"
          class="md:hidden flex items-center justify-center w-10 h-10 text-cuba-white hover:text-cuba-gray-300 transition-all duration-300 hover:bg-cuba-gray-600 rounded-lg"
          aria-label="Abrir menú de navegación"
        >
          <svg class="w-6 h-6 transform transition-transform duration-300 hover:scale-110" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
        </button>
      </MicroInteractions>
    </div>

    <!-- Mobile Navigation mejorado -->
    <div id="mobile-menu" class="md:hidden hidden border-t border-cuba-gray-600 py-4 bg-cuba-black/95 backdrop-blur-sm">
      <!-- Efecto de resplandor en mobile menu -->
      <div class="absolute inset-0 bg-gradient-to-b from-cuba-white via-transparent to-transparent opacity-5 pointer-events-none"></div>
      
      <div class="flex flex-col space-y-4 relative">
        {navItems.map(({ href, label }, index) => (
          <MicroInteractions type="hover-lift" intensity="subtle">
            <a
              href={href}
              class={`relative font-body text-base uppercase tracking-wider transition-all duration-500 hover:text-cuba-white hover:translate-x-2 group ${
                currentPath === href ? 'text-cuba-white' : 'text-cuba-gray-400'
              }`}
              style={`animation-delay: ${index * 100}ms`}
            >
              {label}
              <!-- Indicador móvil -->
              {currentPath === href && (
                <div class="absolute left-0 top-1/2 transform -translate-y-1/2 w-2 h-2 bg-cuba-white rounded-full animate-pulse"></div>
              )}
              <!-- Efecto hover móvil -->
              <div class="absolute left-0 top-1/2 transform -translate-y-1/2 w-0 h-px bg-cuba-white group-hover:w-8 transition-all duration-300"></div>
            </a>
          </MicroInteractions>
        ))}
        <div class="pt-4">
          <MicroInteractions type="glow-border" intensity="medium">
            <Button href="/reservas" variant="primary" size="sm" class="w-full" animated={true}>
              Book Appointment
            </Button>
          </MicroInteractions>
        </div>
      </div>
    </div>
  </nav>
</header>

<script>
  // Mobile menu toggle
  const mobileMenuButton = document.getElementById('mobile-menu-button');
  const mobileMenu = document.getElementById('mobile-menu');
  
  if (mobileMenuButton && mobileMenu) {
    mobileMenuButton.addEventListener('click', () => {
      mobileMenu.classList.toggle('hidden');
    });
  }
</script>
---

---

<!-- MODAL POPUP STRUCTURE -->
<div
    id="artist-modal"
    class="fixed inset-0 z-[100] hidden items-center justify-center p-4 md:p-8"
>
    <!-- Backdrop -->
    <div class="absolute inset-0 modal-backdrop" id="modal-backdrop"></div>

    <!-- Content Container -->
    <div
        class="relative w-full max-w-6xl h-full md:h-[85vh] bg-[#0a0a0a] border border-white/10 flex flex-col rounded-sm modal-content overflow-hidden transform scale-95 opacity-0"
    >
        <!-- Modal Header -->
        <div
            class="flex justify-between items-start p-6 md:p-8 border-b border-white/5 bg-[#0a0a0a] z-10 shrink-0"
        >
            <div>
                <span
                    class="text-red-600 text-[10px] md:text-xs font-bold uppercase tracking-widest block mb-1"
                    >[ ARTIST PORTFOLIO ]</span
                >
                <h2
                    id="modal-artist-name"
                    class="text-4xl md:text-5xl font-bold tracking-tighter text-white uppercase"
                >
                    ARTIST NAME
                </h2>
                <p
                    id="modal-artist-style"
                    class="text-neutral-500 text-sm md:text-base mt-1"
                >
                    Artist Style Description
                </p>
            </div>
            <button
                id="close-modal-btn"
                class="text-white/50 hover:text-white hover:bg-white/10 rounded-full p-2 transition-all"
            >
                <i data-lucide="x" class="w-8 h-8"></i>
            </button>
        </div>

        <!-- Modal Body (Scrollable) -->
        <div class="flex-grow overflow-y-auto p-6 md:p-8 custom-scrollbar">
            <div id="modal-gallery" class="modal-gallery-grid">
                <!-- Javascript will inject images here -->
            </div>

            <div
                class="mt-12 p-8 bg-neutral-900/30 border border-white/5 rounded-sm flex flex-col md:flex-row items-center justify-between gap-6"
            >
                <div class="text-center md:text-left">
                    <h4 class="text-xl font-bold text-white mb-2">
                        Interested in booking?
                    </h4>
                    <p class="text-neutral-400 text-sm max-w-md">
                        Consultations are free. A deposit is required to secure
                        your appointment time.
                    </p>
                </div>
                <a
                    href="#book"
                    id="modal-book-btn"
                    class="btn-outline px-8 py-3 text-xs font-bold bg-white text-black hover:bg-neutral-200 border-none shrink-0"
                >
                    <span>Book Appointment</span>
                </a>
            </div>
        </div>
    </div>
</div>

<script>
    import { gsap } from "gsap";

    const modal = document.getElementById("artist-modal");
    const modalContent = modal?.querySelector(".modal-content");
    const modalName = document.getElementById("modal-artist-name");
    const modalStyle = document.getElementById("modal-artist-style");
    const modalGallery = document.getElementById("modal-gallery");
    let modalTimeline: gsap.core.Timeline | null = null;

    // @ts-ignore
    window.openArtistModal = openArtistModal;

    function openArtistModal(name: string, style: string, images: string[]) {
        if (
            !modal ||
            !modalName ||
            !modalStyle ||
            !modalGallery ||
            !modalContent
        )
            return;

        // Populate Content
        modalName.textContent = name;
        modalStyle.textContent = style;

        // Build Gallery Grid
        modalGallery.innerHTML = images
            .map(
                (imgUrl, index) => `
            <div 
                class="relative group overflow-hidden rounded-sm h-64 bg-neutral-900 border border-white/5 opacity-0 modal-img-item cursor-pointer" 
                style="transition-delay: ${index * 50}ms"
                onclick="window.openImageModal({
                    image: '${imgUrl}',
                    title: '${name} Portfolio Work',
                    tags: ['${style}'],
                    date: '${new Date().getFullYear()}'
                })"
            >
                <div class="img-zoom-container h-full w-full">
                    <img src="${imgUrl}" alt="${name} Work ${index + 1}" class="img-zoom w-full h-full object-cover grayscale group-hover:grayscale-0">
                    
                    <!-- Overlay Icon -->
                    <div class="absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center pointer-events-none">
                        <span class="bg-white/10 backdrop-blur-sm p-2 rounded-full border border-white/20">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 3h6v6"/><path d="M10 14 21 3"/><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/></svg>
                        </span>
                    </div>
                </div>
            </div>
        `,
            )
            .join("");

        // Show Modal Container
        modal.classList.remove("hidden");
        modal.classList.add("flex");

        // Lock Body Scroll
        document.body.style.overflow = "hidden";

        // Animation
        if (modalTimeline) modalTimeline.kill();
        modalTimeline = gsap.timeline();

        modalTimeline
            .to(modal, { opacity: 1, duration: 0.3 })
            .to(
                modalContent,
                { scale: 1, opacity: 1, duration: 0.4, ease: "back.out(1.2)" },
                "-=0.2",
            )
            // @ts-ignore
            .to(
                ".modal-img-item",
                { opacity: 1, y: 0, duration: 0.4, stagger: 0.05 },
                "-=0.2",
            );

        // Re-init lucide icons inside modal if needed, but simple img tags don't use lucide mostly
    }

    function closeArtistModal() {
        if (!modal || !modalContent || !modalGallery) return;
        if (modalTimeline) modalTimeline.kill();
        modalTimeline = gsap.timeline({
            onComplete: () => {
                modal.classList.add("hidden");
                modal.classList.remove("flex");
                document.body.style.overflow = "";
                modalGallery.innerHTML = ""; // Clean up
            },
        });

        modalTimeline
            .to(modalContent, {
                scale: 0.95,
                opacity: 0,
                duration: 0.3,
                ease: "power2.in",
            })
            .to(modal, { opacity: 0, duration: 0.2 }, "-=0.1");
    }

    // Event Listeners
    document
        .getElementById("close-modal-btn")
        ?.addEventListener("click", closeArtistModal);
    document
        .getElementById("modal-backdrop")
        ?.addEventListener("click", closeArtistModal);
    document
        .getElementById("modal-book-btn")
        ?.addEventListener("click", closeArtistModal);

    // Listen for triggers
    document.addEventListener("click", (e) => {
        const target = (e.target as HTMLElement).closest(".open-modal-btn");
        if (target) {
            const btn = target as HTMLElement;
            const name = btn.dataset.name || "";
            const style = btn.dataset.style || "";
            const images = JSON.parse(btn.dataset.images || "[]");
            openArtistModal(name, style, images);
        }
    });

    // Escape key
    document.addEventListener("keydown", (e) => {
        if (
            e.key === "Escape" &&
            modal &&
            !modal.classList.contains("hidden")
        ) {
            closeArtistModal();
        }
    });
</script>
